"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_shared_components_file-upload-dialog_index_ts"],{9399:(D,g,i)=>{i.d(g,{U:()=>R});var l=i(6861),p=i(8071),h=i(3839),m=i(9736),x=i(1527),_=i(9097),T=i(5101),e=i(9039),d=i(9409),r=i(6575),f=i(3910),c=i(895),C=i(2849),v=i(9498),E=i(6537);const U=["installerWindow"];function A(o,n){1&o&&e._UZ(0,"mat-spinner",5)}function M(o,n){1&o&&(e.TgZ(0,"div"),e._uU(1,"Select or drop file"),e.qZA())}function y(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Oqu(t.name)}}function O(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.showAppCatalog())}),e._uU(1," Get recommended Apps from Catalog "),e.qZA()}}function P(o,n){1&o&&(e.TgZ(0,"div",18),e._uU(1," Upload succeeded. See the messages below for more information. "),e.qZA())}function F(o,n){1&o&&(e.TgZ(0,"div",19),e._uU(1," Upload failed. See the messages below for more information. "),e.qZA())}const b=(o,n,t)=>({"sxc-message-warning":o,"sxc-message-success":n,"sxc-message-error":t});function w(o,n){if(1&o&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&o){const t=n.$implicit,a=e.oxw(3);e.Q6J("ngClass",e.kEZ(2,b,t.MessageType===a.FileUploadMessageTypes.Warning,t.MessageType===a.FileUploadMessageTypes.Success,t.MessageType===a.FileUploadMessageTypes.Error)),e.xp6(1),e.hij(" ",t.Text," ")}}function Z(o,n){if(1&o&&(e.TgZ(0,"div",15),e.YNc(1,P,2,0,"div",16)(2,F,2,0,"div",17),e.SjG(3,w,2,6,"div",21,e.x6l),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.um2(1,t.result.Success?1:-1),e.xp6(1),e.um2(2,t.result.Success?-1:2),e.xp6(1),e.wJu(t.result.Messages)}}function L(o,n){1&o&&e._UZ(0,"iframe",22,23)}function B(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.closeDialog())}),e._uU(1,"Cancel"),e.qZA(),e.TgZ(2,"button",26),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.upload())}),e._uU(3," Upload "),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("disabled",!t.files.length||t.uploading||!!t.result)}}function I(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.closeDialog(!0))}),e._uU(1,"Close"),e.qZA()}}function S(o,n){if(1&o&&(e.TgZ(0,"mat-dialog-actions",13),e.YNc(1,B,4,1)(2,I,2,0,"button",24),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.um2(1,null!=t.result&&t.result.Success?-1:1),e.xp6(1),e.um2(2,null!=t.result&&t.result.Success?2:-1)}}function K(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1),e.NdJ("filesDropped",function(s){e.CHM(t);const u=e.oxw();return e.KtG(u.filesDropped(s))}),e.TgZ(1,"div",2),e._UZ(2,"div",3),e.ALo(3,"safeHtml"),e.qZA(),e.TgZ(4,"div",4),e.YNc(5,A,1,0,"mat-spinner",5),e._UZ(6,"p",6),e.ALo(7,"safeHtml"),e.TgZ(8,"div")(9,"button",7),e.NdJ("click",function(){e.CHM(t);const s=e.MAs(14);return e.KtG(s.click())}),e.YNc(10,M,2,0,"div"),e.SjG(11,y,2,1,"div",null,e.x6l),e.qZA(),e.TgZ(13,"input",8,9),e.NdJ("change",function(s){e.CHM(t);const u=e.oxw();return e.KtG(u.filesChanged(s))}),e.qZA(),e.YNc(15,O,2,0,"button",10),e.qZA(),e.YNc(16,Z,5,2,"div",11)(17,L,2,0,"iframe",12),e.qZA(),e.YNc(18,S,3,2,"mat-dialog-actions",13),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("allowedFileTypes",t.dialogData.allowedFileTypes),e.xp6(2),e.Q6J("innerHtml",e.lcZ(3,10,t.dialogData.title),e.oJD),e.xp6(3),e.um2(5,n.uploading?5:-1),e.xp6(1),e.Q6J("innerHtml",e.lcZ(7,12,t.dialogData.description),e.oJD),e.xp6(3),e.Q6J("disabled",n.uploading),e.xp6(1),e.um2(10,n.files.length?-1:10),e.xp6(1),e.wJu(n.files),e.xp6(4),e.um2(15,t.uploadType==t.UploadTypes.App?15:-1),e.xp6(1),e.um2(16,n.result?16:-1),e.xp6(1),e.um2(17,t.uploadType==t.UploadTypes.App&&n.showAppCatalog?17:-1),e.xp6(1),e.um2(18,n.showAppCatalog?-1:18)}}let R=(()=>{class o extends _.f{constructor(t,a,s){super(),this.dialogData=t,this.dialogRef=a,this.snackBar=s,this.hostClass="dialog-component",this.uploading$=new p.X(!1),this.files$=new p.X([]),this.result$=new p.X(void 0),this.FileUploadMessageTypes=T.D,this.UploadTypes=T.p,this.showAppCatalog$=new p.X(!1)}ngOnInit(){this.subscription.add(this.files$.subscribe(()=>{void 0!==this.result$.value&&this.result$.next(void 0)})),null!=this.dialogData.files&&this.filesDropped(this.dialogData.files),this.viewModel$=(0,h.a)([this.uploading$,this.files$,this.result$,this.showAppCatalog$]).pipe((0,m.U)(([t,a,s,u])=>({uploading:t,files:a,result:s,showAppCatalog:u})))}ngOnDestroy(){this.uploading$.complete(),this.files$.complete(),this.result$.complete(),super.ngOnDestroy()}closeDialog(t){this.dialogRef.close(t)}filesDropped(t){this.setFiles(t),this.upload()}filesChanged(t){const s=Array.from(t.target.files);this.setFiles(s)}upload(){this.uploading$.next(!0),this.subscription.add(this.dialogData.upload$(this.files$.value).pipe((0,x.q)(1)).subscribe({next:t=>{this.uploading$.next(!1),this.result$.next(t)},error:()=>{this.uploading$.next(!1),this.result$.next(void 0),this.snackBar.open("Upload failed. Please check console for more information",void 0,{duration:3e3})}}))}showAppCatalog(){this.showAppCatalog$.next(!this.showAppCatalog$.value)}setFiles(t){this.dialogData.multiple||(t=t.slice(0,1)),this.files$.next(t)}static#e=this.\u0275fac=function(a){return new(a||o)(e.Y36(l.WI),e.Y36(l.so),e.Y36(d.ux))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-file-upload-dialog"]],viewQuery:function(a,s){if(1&a&&e.Gf(U,5),2&a){let u;e.iGM(u=e.CRH())&&(s.installerWindow=u.first)}},hostVars:1,hostBindings:function(a,s){2&a&&e.Ikx("className",s.hostClass)},inputs:{uploadType:"uploadType"},features:[e.qOj],decls:2,vars:3,consts:[["class","eav-dialog","appDragAndDrop","",3,"allowedFileTypes"],["appDragAndDrop","",1,"eav-dialog",3,"allowedFileTypes","filesDropped"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title",3,"innerHtml"],[1,"eav-dialog-content"],["mode","indeterminate","diameter","20","color","accent"],[3,"innerHtml"],["mat-raised-button","","tippy","Open file browser",3,"disabled","click"],["type","file","multiple","",1,"hide",3,"change"],["fileInput",""],["mat-raised-button","","class","eav-app-catalog-button","tippy","Open app catalog"],["class","eav-result-container"],["class","eav-app-catalog-iframe","src","//gettingstarted.2sxc.org/router.aspx?Platform=Dnn&SysVersion=9.6.1&SxcVersion=16.07.01&destination=autoconfigureapp&ModuleId=1197&SiteId=16&ZoneID=17&DefaultLanguage=en-us&CurrentLanguage=en-us&SysGuid=DB92DBFC-0C60-4101-93C6-803C2FE244B6&AppId=&fp=c2b7fabe7d51a0a0f6484d72bc119c8bf2d14b8ad29b30696a9148f9845a766c"],["align","end"],["mat-raised-button","","tippy","Open app catalog",1,"eav-app-catalog-button",3,"click"],[1,"eav-result-container"],["class","sxc-message sxc-message-info"],["class","sxc-message sxc-message-error"],[1,"sxc-message","sxc-message-info"],[1,"sxc-message","sxc-message-error"],[1,"sxc-message",3,"ngClass"],["class","sxc-message",3,"ngClass"],["src","//gettingstarted.2sxc.org/router.aspx?Platform=Dnn&SysVersion=9.6.1&SxcVersion=16.07.01&destination=autoconfigureapp&ModuleId=1197&SiteId=16&ZoneID=17&DefaultLanguage=en-us&CurrentLanguage=en-us&SysGuid=DB92DBFC-0C60-4101-93C6-803C2FE244B6&AppId=&fp=c2b7fabe7d51a0a0f6484d72bc119c8bf2d14b8ad29b30696a9148f9845a766c",1,"eav-app-catalog-iframe"],["installerWindow",""],["mat-raised-button","","color","accent"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","accent",3,"click"]],template:function(a,s){if(1&a&&(e.YNc(0,K,19,14,"div",0),e.ALo(1,"async")),2&a){let u;e.um2(0,(u=e.lcZ(1,1,s.viewModel$))?0:-1,u)}},dependencies:[r.mk,f.Ou,c.lW,l.H8,C.z,v.$,r.Ov,E.z],styles:[".eav-result-container[_ngcontent-%COMP%]{margin-top:16px}.eav-app-catalog-button[_ngcontent-%COMP%]{margin-left:12px}.eav-app-catalog-iframe[_ngcontent-%COMP%]{margin-top:16px;width:100%;height:500px;border:none}"]})}return o})()},5101:(D,g,i)=>{i.d(g,{D:()=>l,p:()=>p});const l={Warning:0,Success:1,Error:2},p={App:0,AppPart:1,ContentType:2,ContentItem:3,Query:4,View:5}},7503:(D,g,i)=>{i.d(g,{DS:()=>p.D,UR:()=>l.U,pC:()=>p.p});var l=i(9399),p=i(5101)},2849:(D,g,i)=>{i.d(g,{z:()=>x});var l=i(9039),p=i(9016),h=i(9097),m=i(9409);let x=(()=>{class _ extends h.f{constructor(e,d,r){super(),this.zone=d,this.snackBar=r,this.markStyle="outline",this.allowedFileTypes="",this.filesDropped=new l.vpe,this.dropAreaClass="eav-droparea",this.dragClass="eav-dragover",this.timeouts=[],this.element=e.nativeElement}ngOnInit(){this.markStyleClass=`eav-droparea-${this.markStyle}`,this.element.classList.add(this.dropAreaClass,this.markStyleClass),this.zone.runOutsideAngular(()=>{this.subscription.add((0,p.R)(this.element,"dragover").subscribe(e=>{e.preventDefault(),e.stopPropagation(),this.clearTimeouts(),this.element.classList.add(this.dragClass)})),this.subscription.add((0,p.R)(this.element,"dragleave").subscribe(e=>{e.preventDefault(),e.stopPropagation(),this.timeouts.push(window.setTimeout(()=>{this.element.classList.remove(this.dragClass)},50))}))})}ngOnDestroy(){this.clearTimeouts(),this.element.classList.remove(this.dropAreaClass,this.markStyleClass,this.dragClass),super.ngOnDestroy()}onDrop(e){e.preventDefault(),e.stopPropagation(),this.clearTimeouts(),this.element.classList.remove(this.dragClass);let r=Array.from(e.dataTransfer.files);r=this.filterTypes(r,this.allowedFileTypes),r.length>0&&this.filesDropped.emit(r)}clearTimeouts(){for(const e of this.timeouts)clearTimeout(e);this.timeouts=[]}filterTypes(e,d){if(""===d)return e;const r=d.split(",").map(c=>c.toLocaleLowerCase()),f=e.filter(c=>{const C=c.name.lastIndexOf(".");if(C<=0)return!1;const v=c.name.substring(C+1).toLocaleLowerCase();return r.includes(v)});if(e.length!==f.length){const c=this.allowedFileTypes.replace(/\,/g,", ");this.snackBar.open(f.length?"Some files were filtered out. This drop location only accepts file types: "+c:"This drop location only accepts file types: "+c,null,{duration:5e3})}return f}static#e=this.\u0275fac=function(d){return new(d||_)(l.Y36(l.SBq),l.Y36(l.R0b),l.Y36(m.ux))};static#t=this.\u0275dir=l.lG2({type:_,selectors:[["","appDragAndDrop",""]],hostBindings:function(d,r){1&d&&l.NdJ("drop",function(c){return r.onDrop(c)})},inputs:{markStyle:"markStyle",allowedFileTypes:"allowedFileTypes"},outputs:{filesDropped:"filesDropped"},features:[l.qOj]})}return _})()},6537:(D,g,i)=>{i.d(g,{z:()=>h});var l=i(9039),p=i(6480);let h=(()=>{class m{constructor(_){this.sanitizer=_}transform(_){return this.sanitizer.bypassSecurityTrustHtml(_)}static#e=this.\u0275fac=function(T){return new(T||m)(l.Y36(p.H7,16))};static#t=this.\u0275pipe=l.Yjl({name:"safeHtml",type:m,pure:!0})}return m})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.01.05/dist/ng-edit/default-projects_eav-ui_src_app_shared_components_file-upload-dialog_index_ts.9176a5de8ace75dc.js.map