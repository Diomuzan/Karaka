"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_replace-content_replace-content_component_ts"],{9271:(A,m,e)=>{e.r(m),e.d(m,{ReplaceContentComponent:()=>y});var c=e(8071),d=e(3839),u=e(9736),C=e(712),g=e(6041),M=e(2957),t=e(9039),h=e(91),p=e(6861),R=e(9409),s=e(9498),l=e(895),U=e(6515),T=e(1268),I=e(257),v=e(8849),P=e(9892),B=e(9674),O=e(5918),K=e(6575);function L(r,_){if(1&r&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&r){const n=_.$implicit;t.Q6J("value",n),t.xp6(1),t.Oqu(n)}}function W(r,_){if(1&r){const n=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3),t._uU(3),t.qZA()(),t.TgZ(4,"div",4),t._UZ(5,"router-outlet"),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.TgZ(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),t._uU(11,"Choose item"),t.qZA(),t.TgZ(12,"input",7),t.NdJ("ngModelChange",function(o){t.CHM(n);const a=t.oxw();return t.KtG(a.setFilter(o))}),t.qZA(),t.TgZ(13,"mat-autocomplete",8,9),t.NdJ("optionSelected",function(o){t.CHM(n);const a=t.oxw();return t.KtG(a.select(o))}),t.TgZ(15,"cdk-virtual-scroll-viewport",10),t.YNc(16,L,2,2,"mat-option",11),t.qZA()()(),t.TgZ(17,"button",12),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.copySelected())}),t.TgZ(18,"mat-icon"),t._uU(19,"file_copy"),t.qZA()()()(),t.TgZ(20,"mat-dialog-actions",13)(21,"button",14),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.closeDialog())}),t._uU(22,"Cancel"),t.qZA(),t.TgZ(23,"button",15),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.save())}),t._uU(24,"Save"),t.qZA()()()}if(2&r){const n=t.MAs(14);t.xp6(3),t.Oqu(_.isAddMode?"Add Existing Item":"Replace Content Item"),t.xp6(4),t.hij("",_.isAddMode?"Select a content-item to add to this list.":"By replacing a content-item you can make other content appear in the slot of the original content."," "),t.xp6(5),t.Q6J("matAutocomplete",n)("ngModel",_.filterText),t.xp6(1),t.Q6J("hideSingleSelectionIndicator",!0),t.xp6(2),t.Udp("height",_.filteredOptions.length<6?48*_.filteredOptions.length:240,"px"),t.xp6(1),t.Q6J("cdkVirtualForOf",_.filteredOptions),t.xp6(1),t.Q6J("disabled",!_.isMatch),t.xp6(6),t.Q6J("disabled",!_.isMatch)}}let y=(()=>{class r extends g.H{constructor(n,i,o,a,f){super(n,i),this.router=n,this.route=i,this.dialogRef=o,this.contentGroupService=a,this.snackBar=f,this.hostClass="dialog-component"}ngOnInit(){this.guid=this.route.snapshot.paramMap.get("guid"),this.part=this.route.snapshot.paramMap.get("part"),this.index=parseInt(this.route.snapshot.paramMap.get("index"),10),this.add=!!this.route.snapshot.queryParamMap.get("add"),this.filterText$=new c.X(""),this.options$=new c.X([]);const n=(0,d.a)([this.filterText$,this.options$]).pipe((0,u.U)(([i,o])=>o.filter(a=>a.label.toLocaleLowerCase().includes(i.toLocaleLowerCase())).map(a=>a.label)));this.viewModel$=(0,d.a)([this.filterText$,n]).pipe((0,u.U)(([i,o])=>({filterText:i,filteredOptions:o,isAddMode:this.add,isMatch:o.includes(i)}))),this.fetchConfig(!1,null),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{const o=this.router.getCurrentNavigation().extras?.state,a=o?.[Object.keys(o)[0]];this.fetchConfig(!0,a)}))}ngOnDestroy(){this.filterText$.complete(),this.options$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}setFilter(n){this.filterText$.next(n)}select(n){this.filterText$.next(n.option.value)}copySelected(){const n=this.buildContentGroup(),o=(0,M.f)({items:[{ContentTypeName:this.contentTypeName,DuplicateEntity:n.id}]});this.router.navigate([`edit/${o}`],{relativeTo:this.route})}save(){this.snackBar.open("Saving...");const n=this.buildContentGroup();this.contentGroupService.saveItem(n).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}fetchConfig(n,i){const o=this.buildContentGroup();this.contentGroupService.getItems(o).subscribe(a=>{const f=Object.entries(a.Items).map(([E,D])=>({id:parseInt(E,10),label:`${D} (${E})`}));if(this.options$.next(f),!o.add&&!n||null!=i){const E=n?i:a.SelectedId,D=this.options$.value.find(x=>x.id===E)?.label||"";this.filterText$.next(D)}this.contentTypeName=a.ContentTypeName})}buildContentGroup(){return{id:this.options$.value.find(o=>o.label===this.filterText$.value)?.id??null,guid:this.guid,part:this.part,index:this.index,add:this.add}}static#t=this.\u0275fac=function(i){return new(i||r)(t.Y36(h.F0),t.Y36(h.gz),t.Y36(p.so),t.Y36(C.e),t.Y36(R.ux))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-replace-content"]],hostVars:1,hostBindings:function(i,o){2&i&&t.Ikx("className",o.hostClass)},features:[t.qOj],decls:2,vars:3,consts:[["class","eav-dialog"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[1,"eav-options-box"],["color","accent",1,"eav-form-field"],["matInput","",3,"matAutocomplete","ngModel","ngModelChange"],[3,"hideSingleSelectionIndicator","optionSelected"],["auto","matAutocomplete"],["itemSize","48","minBufferPx","500","maxBufferPx","1000"],[3,"value",4,"cdkVirtualFor","cdkVirtualForOf"],["mat-icon-button","","tippy","Copy",3,"disabled","click"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[3,"value"]],template:function(i,o){if(1&i&&(t.YNc(0,W,25,10,"div",0),t.ALo(1,"async")),2&i){let a;t.um2(0,(a=t.lcZ(1,1,o.viewModel$))?0:-1,a)}},dependencies:[h.lC,s.$,p.H8,l.lW,l.RK,U.Hw,T.KE,T.hX,I.ey,v.Fj,v.JJ,v.On,P.XC,P.ZL,B.Nt,O.xd,O.x0,O.N7,K.Ov],styles:[".eav-options-box[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]})}return r})()},6041:(A,m,e)=>{e.d(m,{H:()=>h});var c=e(91),d=e(4520),u=e(5043),C=e(9736),g=e(9422),M=e(9097),t=e(9039);let h=(()=>{class p extends M.f{constructor(s,l){super(),this.router=s,this.route=l}ngOnDestroy(){super.ngOnDestroy()}refreshOnChildClosedDeep(){return this.router.events.pipe((0,d.h)(s=>s instanceof c.m2),(0,u.O)(!!this.route.snapshot.firstChild.firstChild),(0,C.U)(()=>!!this.route.snapshot.firstChild.firstChild),(0,g.G)(),(0,d.h)(([s,l])=>s&&!l))}refreshOnChildClosedShallow(){return this.router.events.pipe((0,d.h)(s=>s instanceof c.m2),(0,u.O)(!!this.route.snapshot.firstChild),(0,C.U)(()=>!!this.route.snapshot.firstChild),(0,g.G)(),(0,d.h)(([s,l])=>s&&!l))}static#t=this.\u0275fac=function(l){return new(l||p)(t.Y36(c.F0),t.Y36(c.gz))};static#e=this.\u0275dir=t.lG2({type:p,features:[t.qOj]})}return p})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.01.05/dist/ng-edit/projects_eav-ui_src_app_replace-content_replace-content_component_ts.b694e0ff4ba06250.js.map