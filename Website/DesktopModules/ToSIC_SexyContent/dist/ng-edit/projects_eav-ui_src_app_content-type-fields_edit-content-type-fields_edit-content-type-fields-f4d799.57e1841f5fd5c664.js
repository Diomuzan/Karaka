"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-f4d799"],{6335:(R,F,o)=>{o.r(F),o.d(F,{EditContentTypeFieldsComponent:()=>Wt});var l=o(8849),c=o(8071),g=o(5584),C=o(1891),i=o(9736),_=o(4300),T=o(4980),D=o(4520),w=o(5616),b=o(2389),A=o(7938),f=o(4114);const x=(n,r)=>(n.push(r),n);function S(){return(0,f.e)((n,r)=>{(function M(n,r){return(0,f.e)((0,A.U)(n,r,arguments.length>=2,!1,!0))})(x,[])(n).subscribe(r)})}const I=/^[A-Za-z][A-Za-z0-9]+$/,$="Standard letters and numbers are allowed. Must start with a letter.";var K=o(5530),L=o(9097),E=o(6191),B=o(5809),Z=o(9294),h=o(5807);const N={Boolean:{label:(0,Z.C)(E.Q.Boolean),description:"Yes/no or true/false values"},Custom:{label:(0,Z.C)(E.Q.Custom),description:"Use for things like gps-pickers (which writes into multiple fields) or for custom-data which serializes something exotic into the db like an array, a custom json or anything"},DateTime:{label:(0,Z.C)(E.Q.DateTime),description:"For date, time or combined values"},Empty:{label:(0,Z.C)(E.Q.Empty),description:"Use to structure your form"},Entity:{label:(0,Z.C)(E.Q.Entity),description:"One or more other content-items"},Hyperlink:{label:(0,Z.C)(E.Q.Hyperlink),description:"Hyperlink or reference to a picture / file"},Number:{label:(0,Z.C)(E.Q.Number),description:"Any kind of number"},String:{label:(0,Z.C)(E.Q.String),description:"Any kind of text"}};var y=o(716),v=o(6861),m=o(5299),U=o(1527),J=o(5331),it=o(8968),t=o(9039),W=o(9409),ot=o(7648),j=o(9851),X=o(895),q=o(9674),Q=o(1268),at=o(8497),st=o(425);let z=(()=>{class n{constructor(){this.reservedNames={}}validate(e){if(!e.value)return null;const a=e.value.toLocaleLowerCase(),s=Object.keys(this.reservedNames).find(d=>d.toLocaleLowerCase()===a);return s?{reservedNames:this.reservedNames[s]}:null}static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275dir=t.lG2({type:n,selectors:[["","appReservedNames",""]],inputs:{reservedNames:["appReservedNames","reservedNames"]},features:[t._Bn([{provide:l.Cf,useExisting:n,multi:!0}])]})}return n})();var k=o(6575),V=o(1916);const lt=["ngForm"];function dt(n,r){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"Content Type"),t.qZA()())}function rt(n,r){if(1&n&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.hij(" ",e.ContentType.Name," ")}}function ct(n,r){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"Name"),t.qZA()())}function pt(n,r){if(1&n&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.hij(" ",e.StaticName," ")}}function ut(n,r){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"Type"),t.qZA()())}function mt(n,r){if(1&n&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.hij(" ",e.Type," ")}}function ft(n,r){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"Share"),t.qZA()())}function ht(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",27)(1,"button",22),t.NdJ("click",function(){const d=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.selectField(d))}),t._uU(2,"Select"),t.qZA()()}}function gt(n,r){1&n&&t._UZ(0,"tr",28)}function _t(n,r){1&n&&t._UZ(0,"tr",29)}function Ct(n,r){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"New Name"),t.qZA()())}function vt(n,r){if(1&n&&(t.TgZ(0,"app-field-hint",33),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.Q6J("isError",!0),t.xp6(1),t.Oqu(e.fieldNameError)}}function Tt(n,r){if(1&n&&(t.TgZ(0,"app-field-hint",33),t._uU(1),t.qZA()),2&n){t.oxw(2);const e=t.MAs(5);t.Q6J("isError",!0),t.xp6(1),t.hij(" ",e.errors.reservedNames," ")}}function yt(n,r){if(1&n&&t.YNc(0,vt,2,2,"app-field-hint",33)(1,Tt,2,2,"app-field-hint",33),2&n){t.oxw();const e=t.MAs(5);t.um2(0,e.errors.pattern?0:-1),t.xp6(1),t.um2(1,e.errors.reservedNames?1:-1)}}function Ft(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",27)(1,"mat-form-field",30)(2,"mat-label"),t._uU(3,"New Name"),t.qZA(),t.TgZ(4,"input",31,32),t.NdJ("ngModelChange",function(s){const u=t.CHM(e).$implicit;return t.KtG(u.newName=s)}),t.qZA()(),t.YNc(6,yt,2,2),t.qZA()}if(2&n){const e=r.$implicit,a=r.index,s=t.MAs(5),d=t.oxw();t.xp6(4),t.Q6J("pattern",d.fieldNamePattern)("ngModel",e.newName)("name","StaticName"+a)("appReservedNames",d.reservedNames),t.xp6(2),t.um2(6,s.errors?6:-1)}}function xt(n,r){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"Source"),t.qZA()())}function bt(n,r){if(1&n&&(t.TgZ(0,"td",34),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.lnq(" ",e.field.ContentType.Name,"/",e.field.StaticName," (",e.field.Type,") ")}}function At(n,r){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"Remove"),t.qZA()())}function St(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",27)(1,"button",22),t.NdJ("click",function(){const d=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.removeField(d))}),t._uU(2,"Remove"),t.qZA()()}}function Zt(n,r){1&n&&t._UZ(0,"tr",28)}function Mt(n,r){1&n&&t._UZ(0,"tr",29)}let Nt=(()=>{class n extends L.f{constructor(e,a,s,d,u,Y,P,H){super(),this.dialogData=e,this.dialogRef=a,this.contentTypesFieldsService=s,this.snackBar=d,this.featuresService=u,this.dialog=Y,this.viewContainerRef=P,this.changeDetectorRef=H,this.hostClass="dialog-component",this.displayedShareableFieldsColumns=["contentType","name","type","share"],this.displayedSelectedFieldsColumns=["newName","source","remove"],this.shareableFields=new m.by([]),this.selectedFields=new m.by([]),this.fieldNamePattern=I,this.fieldNameError=$,this.saving$=new c.X(!1),this.dialogRef.disableClose=!0,this.subscription.add(this.dialogRef.backdropClick().subscribe(()=>{(this.form.dirty||this.selectedFields.data.length>0)&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||this.closeDialog()}))}ngOnInit(){this.subscription.add(this.contentTypesFieldsService.getShareableFields().subscribe(e=>{this.shareableFields.data=e})),this.subscription.add(this.contentTypesFieldsService.getReservedNames().subscribe(e=>{const a={};this.dialogData.existingFields.forEach(s=>{a[s.StaticName]="Field with this name already exists"}),this.reservedNames={...e,...a}}))}ngOnDestroy(){this.saving$.complete(),super.ngOnDestroy()}selectField(e){const a=this.selectedFields.data;a.push({newName:e.StaticName,field:e}),this.selectedFields.data=a}removeField(e){const a=this.selectedFields.data;a.splice(a.indexOf(e),1),this.selectedFields.data=a}save(){this.featuresService.isEnabled$(J.C.FieldShareConfigManagement).pipe((0,U.q)(1)).subscribe(e=>{e?(this.saving$.next(!0),this.snackBar.open("Saving..."),(0,T.of)(...this.selectedFields.data).pipe((0,D.h)(a=>!!a.newName),(0,w.b)(a=>this.contentTypesFieldsService.addInheritedField(this.dialogData.contentType.Id,a.field.ContentType.Id,a.field.Guid,a.newName).pipe((0,b.K)(s=>(0,T.of)(null)))),S()).subscribe(a=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})):it.B.openDialog(this.dialog,J.C.FieldShareConfigManagement,this.viewContainerRef,this.changeDetectorRef)})}closeDialog(){this.dialogRef.close()}static#t=this.\u0275fac=function(a){return new(a||n)(t.Y36(v.WI),t.Y36(v.so),t.Y36(h.Mr),t.Y36(W.ux),t.Y36(ot.k),t.Y36(v.uw),t.Y36(t.s_b),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-add-sharing-fields"]],viewQuery:function(a,s){if(1&a&&t.Gf(lt,5,l.F),2&a){let d;t.iGM(d=t.CRH())&&(s.form=d.first)}},hostVars:1,hostBindings:function(a,s){2&a&&t.Ikx("className",s.hostClass)},features:[t.qOj],decls:50,vars:16,consts:[[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[1,"eav-tables-div"],[1,"eav-table-div-left"],["mat-table","",1,"eav-fields-table",3,"dataSource"],["matColumnDef","contentType"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","eav-table-cell",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","type"],["matColumnDef","share"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"eav-table-div-right"],["ngForm","ngForm"],["matColumnDef","newName"],["matColumnDef","source"],["mat-cell","","style","word-break:break-all;","class","eav-table-cell",4,"matCellDef"],["matColumnDef","remove"],["align","end"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled","click"],[1,"eav-button-feature"],[1,"eav-button-feature-icon",3,"featureNameId"],["mat-header-cell",""],["mat-cell","",1,"eav-table-cell"],["mat-header-row",""],["mat-row",""],["color","accent",1,"eav-form-field"],["matInput","",3,"pattern","ngModel","name","appReservedNames","ngModelChange"],["newName","ngModel"],[3,"isError"],["mat-cell","",1,"eav-table-cell",2,"word-break","break-all"]],template:function(a,s){if(1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"div",3)(6,"span"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"div",4)(10,"mat-card",5)(11,"table",6),t.ynx(12,7),t.YNc(13,dt,3,0,"th",8)(14,rt,2,1,"td",9),t.BQk(),t.ynx(15,10),t.YNc(16,ct,3,0,"th",8)(17,pt,2,1,"td",9),t.BQk(),t.ynx(18,11),t.YNc(19,ut,3,0,"th",8)(20,mt,2,1,"td",9),t.BQk(),t.ynx(21,12),t.YNc(22,ft,3,0,"th",8)(23,ht,3,0,"td",9),t.BQk(),t.YNc(24,gt,1,0,"tr",13)(25,_t,1,0,"tr",14),t.qZA()(),t.TgZ(26,"mat-card",15)(27,"form",null,16)(29,"table",6),t.ynx(30,17),t.YNc(31,Ct,3,0,"th",8)(32,Ft,7,5,"td",9),t.BQk(),t.ynx(33,18),t.YNc(34,xt,3,0,"th",8)(35,bt,2,3,"td",19),t.BQk(),t.ynx(36,20),t.YNc(37,At,3,0,"th",8)(38,St,3,0,"td",9),t.BQk(),t.YNc(39,Zt,1,0,"tr",13)(40,Mt,1,0,"tr",14),t.qZA()()()(),t.TgZ(41,"mat-dialog-actions",21)(42,"button",22),t.NdJ("click",function(){return s.closeDialog()}),t._uU(43,"Cancel"),t.qZA(),t.TgZ(44,"button",23),t.NdJ("click",function(){return s.save()}),t.ALo(45,"async"),t.TgZ(46,"div",24)(47,"span"),t._uU(48,"Save"),t.qZA(),t._UZ(49,"app-feature-icon-indicator",25),t.qZA()()()()()),2&a){const d=t.MAs(28);t.xp6(3),t.hij(" ",t.lcZ(4,10,"SharingOrInheriting.TitleAddFieldsWhichInherit")," "),t.xp6(4),t.Oqu(t.lcZ(8,12,"SharingOrInheriting.PickFieldsToInheritFrom")),t.xp6(4),t.Q6J("dataSource",s.shareableFields),t.xp6(13),t.Q6J("matHeaderRowDef",s.displayedShareableFieldsColumns),t.xp6(1),t.Q6J("matRowDefColumns",s.displayedShareableFieldsColumns),t.xp6(4),t.Q6J("dataSource",s.selectedFields),t.xp6(10),t.Q6J("matHeaderRowDef",s.displayedSelectedFieldsColumns),t.xp6(1),t.Q6J("matRowDefColumns",s.displayedSelectedFieldsColumns),t.xp6(4),t.Q6J("disabled",!d.form.valid||0==s.selectedFields.data.length||t.lcZ(45,14,s.saving$)),t.xp6(5),t.Q6J("featureNameId","FieldShareConfigManagement")}},dependencies:[j.Y,v.H8,X.lW,l._Y,l.Fj,l.JJ,l.JL,l.c5,l.On,l.F,q.Nt,Q.KE,Q.hX,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,at.a8,st.F,z,k.Ov,V.X$],styles:[".eav-tables-div[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;margin-top:4px;padding-top:4px;height:400px}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-div-left[_ngcontent-%COMP%]{width:50%;height:100%;margin-right:4px;overflow-y:auto;border:1px solid rgba(0,0,0,.1)}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-div-right[_ngcontent-%COMP%]{width:50%;height:100%;margin-left:4px;overflow-y:auto;border:1px solid rgba(0,0,0,.1)}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-div-right[_ngcontent-%COMP%]   .eav-form-field[_ngcontent-%COMP%]{max-width:150px}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-cell[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.1)}.eav-tables-div[_ngcontent-%COMP%]   .mat-column-source[_ngcontent-%COMP%]{min-width:150px}.eav-button-feature[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.eav-button-feature[_ngcontent-%COMP%]   .eav-button-feature-icon[_ngcontent-%COMP%]{margin-left:4px;margin-top:6px}"]})}return n})();var Ot=o(91),Et=o(40),Dt=o(6515),tt=o(6355),It=o(257);const wt=["ngForm"];function Ut(n,r){1&n&&t._uU(0," Fields ")}function Pt(n,r){1&n&&t._uU(0," Add Fields ")}function $t(n,r){1&n&&t._uU(0," Edit Field ")}function Yt(n,r){if(1&n&&(t.TgZ(0,"app-field-hint",18),t._uU(1),t.qZA()),2&n){const e=t.oxw(4);t.Q6J("isError",!0),t.xp6(1),t.Oqu(e.fieldNameError)}}function Ht(n,r){if(1&n&&(t.TgZ(0,"app-field-hint",18),t._uU(1),t.qZA()),2&n){t.oxw(2);const e=t.MAs(6);t.Q6J("isError",!0),t.xp6(1),t.hij(" ",e.errors.reservedNames," ")}}function Rt(n,r){if(1&n&&t.YNc(0,Yt,2,2,"app-field-hint",18)(1,Ht,2,2,"app-field-hint",18),2&n){t.oxw();const e=t.MAs(6);t.um2(0,e.errors.pattern?0:-1),t.xp6(1),t.um2(1,e.errors.reservedNames?1:-1)}}function Lt(n,r){if(1&n&&(t.TgZ(0,"mat-option",19)(1,"mat-icon",16),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()),2&n){const e=r.$implicit;t.Q6J("value",e.name),t.xp6(2),t.Oqu(e.icon),t.xp6(2),t.Oqu(e.label)}}function Bt(n,r){if(1&n&&(t.TgZ(0,"mat-icon",17),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.icon)}}const Jt=n=>({"eav-input-obsolete":n});function Qt(n,r){if(1&n&&(t.TgZ(0,"mat-option",20)(1,"div")(2,"span"),t._uU(3),t.qZA(),t.YNc(4,Bt,2,1,"mat-icon",21),t.qZA()()),2&n){const e=r.$implicit;t.Q6J("value",e.inputType)("ngClass",t.VKq(4,Jt,e.isObsolete)),t.xp6(3),t.Oqu(e.label),t.xp6(1),t.um2(4,e.icon?4:-1)}}function Kt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",10)(1,"div",11)(2,"mat-form-field",12)(3,"mat-label"),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"input",13,14),t.NdJ("ngModelChange",function(s){const u=t.CHM(e).$implicit;return t.KtG(u.StaticName=s)}),t.qZA()(),t.YNc(7,Rt,2,2),t.qZA(),t.TgZ(8,"div",11)(9,"mat-form-field",12)(10,"mat-label"),t._uU(11,"Data Type"),t.qZA(),t.TgZ(12,"mat-select",15),t.NdJ("selectionChange",function(){const d=t.CHM(e).$index,u=t.oxw(2);return u.filterInputTypeOptions(d),u.resetInputType(d),t.KtG(u.calculateHints(d))})("ngModelChange",function(s){const u=t.CHM(e).$implicit;return t.KtG(u.Type=s)}),t.TgZ(13,"mat-select-trigger")(14,"mat-icon",16),t._uU(15),t.qZA(),t.TgZ(16,"span"),t._uU(17),t.qZA()(),t.SjG(18,Lt,5,3,"mat-option",19,t.x6l),t.qZA()(),t.TgZ(20,"app-field-hint"),t._uU(21),t.qZA()(),t.TgZ(22,"div",11)(23,"mat-form-field",12)(24,"mat-label"),t._uU(25,"Input Type"),t.qZA(),t.TgZ(26,"mat-select",15),t.NdJ("selectionChange",function(){const d=t.CHM(e).$index,u=t.oxw(2);return t.KtG(u.calculateHints(d))})("ngModelChange",function(s){const u=t.CHM(e).$implicit;return t.KtG(u.InputType=s)}),t.TgZ(27,"mat-select-trigger")(28,"span"),t._uU(29),t.qZA(),t.TgZ(30,"mat-icon",17),t._uU(31),t.qZA()(),t.SjG(32,Qt,5,6,"mat-option",20,t.x6l),t.qZA()(),t.TgZ(34,"app-field-hint"),t._uU(35),t.qZA()()()}if(2&n){const e=r.$implicit,a=r.$index,s=t.MAs(6),d=t.oxw(2);let u,Y;t.xp6(5),t.Q6J("pattern",d.fieldNamePattern)("appReservedNames",d.reservedNames)("ngModel",e.StaticName)("name","StaticName"+a)("disabled","inputType"===d.editMode),t.xp6(2),t.um2(7,s.touched&&s.errors?7:-1),t.xp6(5),t.Q6J("ngModel",e.Type)("name","Type"+a)("disabled",null!=d.editMode),t.xp6(3),t.Oqu(d.findIcon(e.Type)),t.xp6(2),t.Oqu(d.findLabel(e.Type)),t.xp6(1),t.wJu(d.dataTypes),t.xp6(3),t.Oqu(d.dataTypeHints[a]),t.xp6(5),t.Q6J("ngModel",e.InputType)("name","InputType"+a)("disabled","name"===d.editMode),t.xp6(3),t.Oqu(null==(u=d.getInputTypeOption(e.InputType))?null:u.label),t.xp6(2),t.Oqu(null==(Y=d.getInputTypeOption(e.InputType))?null:Y.icon),t.xp6(1),t.wJu(d.filteredInputTypeOptions[a]),t.xp6(3),t.Oqu(d.inputTypeHints[a])}}function kt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.addSharedField())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SharingOrInheriting.AddSharedField")))}function Gt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"form",3,4),t.NdJ("ngSubmit",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.save())}),t.TgZ(2,"div",5),t.SjG(3,Kt,36,18,"div",22,t.x6l),t.qZA(),t.TgZ(5,"mat-dialog-actions"),t.YNc(6,kt,3,3,"button",6),t.ALo(7,"async"),t._UZ(8,"div",7),t.TgZ(9,"button",8),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.closeDialog())}),t._uU(10,"Cancel"),t.qZA(),t.TgZ(11,"button",9),t.ALo(12,"async"),t._uU(13," Save "),t.qZA()()()}if(2&n){const e=t.MAs(1),a=t.oxw();t.xp6(3),t.wJu(a.fields),t.xp6(3),t.um2(6,t.lcZ(7,2,a.debugEnabled$)?6:-1),t.xp6(5),t.Q6J("disabled",!e.form.valid||t.lcZ(12,4,a.saving$))}}let Wt=(()=>{class n extends L.f{constructor(e,a,s,d,u,Y,P){super(),this.dialogRef=e,this.route=a,this.contentTypesService=s,this.contentTypesFieldsService=d,this.globalConfigService=u,this.snackBar=Y,this.dialog=P,this.hostClass="dialog-component",this.fields=[],this.existingFields=[],this.filteredInputTypeOptions=[],this.dataTypeHints=[],this.inputTypeHints=[],this.fieldNamePattern=I,this.fieldNameError=$,this.findIcon=Z.x,this.findLabel=Z.C,this.loading$=new c.X(!0),this.saving$=new c.X(!1),this.debugEnabled$=this.globalConfigService.getDebugEnabled$(),this.dialogRef.disableClose=!0,this.subscription.add(this.dialogRef.backdropClick().subscribe(H=>{this.form.dirty&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||this.closeDialog()}))}ngOnInit(){this.editMode=this.route.snapshot.paramMap.get("editMode");const e=this.route.snapshot.paramMap.get("contentTypeStaticName"),a=this.contentTypesService.retrieveContentType(e).pipe((0,g.B)()),s=a.pipe((0,C.w)(P=>this.contentTypesFieldsService.getFields(P.StaticName))),d=this.contentTypesFieldsService.typeListRetrieve().pipe((0,i.U)(P=>function p(n){const r=[];for(const e of n)r.push({name:e,label:N[e].label,icon:(0,Z.x)(e),description:N[e].description});return r}(P))),u=this.contentTypesFieldsService.getInputTypesList(),Y=this.contentTypesFieldsService.getReservedNames();(0,_.D)([a,s,d,u,Y]).subscribe(([P,H,G,jt,Xt])=>{this.contentType=P,this.dataTypes=G,this.inputTypeOptions=jt,this.existingFields=H;const et={};if(H.forEach(O=>{et[O.StaticName]="Field with this name already exists"}),this.reservedNames={...Xt,...et},null!=this.editMode){const O=this.route.snapshot.paramMap.get("id")?parseInt(this.route.snapshot.paramMap.get("id"),10):null,nt=H.find(qt=>qt.Id===O);"name"===this.editMode&&delete this.reservedNames[nt.StaticName],this.fields.push(nt)}else for(let O=1;O<=8;O++)this.fields.push({Id:0,Type:E.Q.String,InputType:B.v.StringDefault,StaticName:"",IsTitle:0===H.length,SortOrder:H.length+O});for(let O=0;O<this.fields.length;O++)this.filterInputTypeOptions(O),this.calculateHints(O);this.loading$.next(!1)})}ngOnDestroy(){this.loading$.complete(),this.saving$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}filterInputTypeOptions(e){this.filteredInputTypeOptions[e]=this.inputTypeOptions.filter(a=>a.dataType===this.fields[e].Type.toLocaleLowerCase())}resetInputType(e){let a=this.fields[e].Type.toLocaleLowerCase()+B.v.DefaultSuffix;this.filteredInputTypeOptions[e].some(d=>d.inputType===a)||(a=this.filteredInputTypeOptions[e][0].inputType),this.fields[e].InputType=a}calculateHints(e){const a=this.dataTypes.find(d=>d.name===this.fields[e].Type),s=this.inputTypeOptions.find(d=>d.inputType===this.fields[e].InputType);this.dataTypeHints[e]=a?.description??"",this.inputTypeHints[e]=s?.isObsolete?`OBSOLETE - ${s.obsoleteMessage}`:s?.description??""}getInputTypeOption(e){return this.inputTypeOptions.find(a=>a.inputType===e)}addSharedField(){this.dialog.open(Nt,{autoFocus:!1,width:"1600px",data:{contentType:this.contentType,existingFields:this.existingFields}})}save(){if(this.saving$.next(!0),this.snackBar.open("Saving..."),null!=this.editMode){const e=this.fields[0];"name"===this.editMode?this.contentTypesFieldsService.rename(e.Id,this.contentType.Id,e.StaticName).subscribe(()=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()}):"inputType"===this.editMode&&this.contentTypesFieldsService.updateInputType(e.Id,e.StaticName,e.InputType).subscribe(()=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}else(0,T.of)(...this.fields).pipe((0,D.h)(e=>!!e.StaticName),(0,w.b)(e=>this.contentTypesFieldsService.add(e,this.contentType.Id).pipe((0,b.K)(a=>(0,T.of)(null)))),S()).subscribe(e=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}static#t=this.\u0275fac=function(a){return new(a||n)(t.Y36(v.so),t.Y36(Ot.gz),t.Y36(K.s),t.Y36(h.Mr),t.Y36(y.bE),t.Y36(W.ux),t.Y36(v.uw))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-edit-content-type-fields"]],viewQuery:function(a,s){if(1&a&&t.Gf(wt,5,l.F),2&a){let d;t.iGM(d=t.CRH())&&(s.form=d.first)}},hostVars:1,hostBindings:function(a,s){2&a&&t.Ikx("className",s.hostClass)},features:[t.qOj],decls:8,vars:6,consts:[["appToggleDebug","",1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[3,"ngSubmit"],["ngForm","ngForm"],[1,"eav-dialog-content"],["mat-raised-button","","type","button"],[1,"spacer"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[1,"eav-row-container"],[1,"eav-edit-input"],["color","accent",1,"eav-form-field"],["matInput","",3,"pattern","appReservedNames","ngModel","name","disabled","ngModelChange"],["staticName","ngModel"],[3,"ngModel","name","disabled","selectionChange","ngModelChange"],[1,"eav-type-icon"],[1,"eav-input-icon"],[3,"isError"],[3,"value"],[3,"value","ngClass"],["class","eav-input-icon"],["class","eav-row-container"]],template:function(a,s){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t.YNc(3,Ut,1,0)(4,Pt,1,0)(5,$t,1,0),t.qZA()(),t.YNc(6,Gt,14,6,"form"),t.ALo(7,"async"),t.qZA()),2&a&&(t.xp6(3),t.um2(3,void 0===s.editMode?3:-1),t.xp6(1),t.um2(4,null===s.editMode?4:-1),t.xp6(1),t.um2(5,null!=s.editMode?5:-1),t.xp6(1),t.um2(6,!1===t.lcZ(7,4,s.loading$)?6:-1))},dependencies:[k.mk,j.Y,Et.D,v.H8,X.lW,Dt.Hw,l._Y,l.Fj,l.JJ,l.JL,l.c5,l.On,l.F,q.Nt,Q.KE,Q.hX,tt.gD,tt.$L,It.ey,z,k.Ov,V.X$],styles:[".eav-row-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px;width:30%}.eav-type-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-right:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-left:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-obsolete[_ngcontent-%COMP%]{-webkit-text-decoration:black line-through;text-decoration:black line-through;color:#696969}"]})}return n})()},425:(R,F,o)=>{o.d(F,{F:()=>b});var l=o(8968),c=o(9039),g=o(6861),C=o(7648),i=o(6515),_=o(9498),T=o(6575),D=o(1916);function w(A,f){1&A&&(c.TgZ(0,"mat-icon",0),c.ALo(1,"translate"),c._uU(2,"diamond"),c.qZA()),2&A&&c.Q6J("tippy",c.lcZ(1,1,"Features.NotActivated"))}let b=(()=>{class A extends l.B{constructor(M,x,S,I){super(M,x,I,S)}static#t=this.\u0275fac=function(x){return new(x||A)(c.Y36(g.uw),c.Y36(c.s_b),c.Y36(C.k),c.Y36(c.sBO))};static#e=this.\u0275cmp=c.Xpm({type:A,selectors:[["app-feature-icon-indicator"]],features:[c.qOj],decls:2,vars:3,consts:[[3,"tippy"]],template:function(x,S){1&x&&(c.YNc(0,w,3,3,"mat-icon",0),c.ALo(1,"async")),2&x&&c.um2(0,c.lcZ(1,1,S.show$)?0:-1)},dependencies:[i.Hw,_.$,T.Ov,D.X$]})}return A})()},5331:(R,F,o)=>{o.d(F,{C:()=>l});const l={AppSyncWithSiteFiles:"AppSyncWithSiteFiles",WysiwygPasteFormatted:"WysiwygPasteFormatted",PasteImageFromClipboard:"PasteImageFromClipboard",EditUiShowNotes:"EditUiShowNotes",EditUiShowMetadataFor:"EditUiShowMetadataFor",NoSponsoredByToSic:"NoSponsoredByToSic",EditUiTranslateWithGoogle:"EditUiTranslateWithGoogle",LightSpeed:"LightSpeedOutputCache",ContentSecurityPolicy:"ContentSecurityPolicy",PermissionsByLanguage:"PermissionsByLanguage",FieldShareConfigManagement:"FieldShareConfigManagement"}},8968:(R,F,o)=>{o.d(F,{B:()=>Z});var l=o(6861),c=o(3839),g=o(9736),C=o(4472),i=o(9039),_=o(9409),T=o(8737),D=o(895),w=o(6515),b=o(8497),A=o(9498),f=o(6575),M=o(6537),x=o(1916);function S(h,N){if(1&h){const p=i.EpF();i.TgZ(0,"div",1)(1,"div",2),i._uU(2,"ID:"),i.qZA(),i.TgZ(3,"div",8)(4,"span",9),i.NdJ("click",function(){const m=i.CHM(p),U=i.oxw(2);return i.KtG(U.copyToClipboard(m))}),i._uU(5),i.qZA()()()}2&h&&(i.xp6(4),i.Q6J("tippy",N),i.xp6(1),i.Oqu(N))}function I(h,N){if(1&h){const p=i.EpF();i.TgZ(0,"button",10),i.NdJ("click",function(){const m=i.CHM(p),U=i.oxw(2);return i.KtG(U.findOutMore(m))}),i.TgZ(1,"mat-icon"),i._uU(2,"open_in_new"),i.qZA(),i._uU(3),i.ALo(4,"translate"),i.qZA()}2&h&&(i.xp6(3),i.hij(" ",i.lcZ(4,1,"Features.FindOutMore")," "))}function $(h,N){if(1&h){const p=i.EpF();i.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),i._uU(3),i.qZA()(),i.TgZ(4,"mat-card-content"),i._UZ(5,"p",0),i.ALo(6,"safeHtml"),i.TgZ(7,"div",1)(8,"div",2),i._uU(9),i.ALo(10,"translate"),i.qZA(),i.TgZ(11,"div",3)(12,"span"),i._uU(13),i.ALo(14,"translate"),i.qZA()()(),i.YNc(15,S,6,2,"div",4),i.qZA(),i.TgZ(16,"mat-card-actions",5),i.YNc(17,I,5,3,"button",6),i.TgZ(18,"button",7),i.NdJ("click",function(){i.CHM(p);const v=i.oxw();return i.KtG(v.closeDialog())}),i._uU(19),i.ALo(20,"translate"),i.qZA()()()}if(2&h){let p;i.xp6(3),i.Oqu(N.feature.Name),i.xp6(2),i.Q6J("innerHtml",i.lcZ(6,7,N.feature.Description),i.oJD),i.xp6(4),i.hij("",i.lcZ(10,9,"Features.Status"),":"),i.xp6(4),i.Oqu(i.lcZ(14,11,N.feature.IsEnabled?"Features.Active":"Features.NotActive")),i.xp6(2),i.um2(15,(p=N.feature.NameId)?15:-1,p),i.xp6(2),i.um2(17,(p=N.feature.Link)?17:-1,p),i.xp6(2),i.hij(" ",i.lcZ(20,13,"Features.Close")," ")}}let K=(()=>{class h{constructor(p,y,v,m){this.dialogData=p,this.dialogRef=y,this.snackBar=v,this.featureDetailService=m}ngOnInit(){this.viewModel$=(0,c.a)([this.featureDetailService.getFeatureDetails(this.dialogData)]).pipe((0,g.U)(([p])=>({feature:p})))}copyToClipboard(p){(0,C.v)(p),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}findOutMore(p){window.open(p,"_blank")}closeDialog(){this.dialogRef.close()}static#t=this.\u0275fac=function(y){return new(y||h)(i.Y36(l.WI),i.Y36(l.so),i.Y36(_.ux),i.Y36(T.f))};static#e=this.\u0275cmp=i.Xpm({type:h,selectors:[["app-feature-info-dialog"]],decls:2,vars:3,consts:[[3,"innerHtml"],[1,"eav-info-row"],[1,"eav-info-row__label"],[1,"eav-info-row__value"],["class","eav-info-row"],["align","end"],["mat-raised-button","","color","accent","class","eav-card-action-button"],["mat-raised-button","",1,"eav-card-action-button",3,"click"],[1,"eav-info-row__value","eav_click"],[3,"tippy","click"],["mat-raised-button","","color","accent",1,"eav-card-action-button",3,"click"]],template:function(y,v){if(1&y&&(i.YNc(0,$,21,15,"mat-card"),i.ALo(1,"async")),2&y){let m;i.um2(0,(m=i.lcZ(1,1,v.viewModel$))?0:-1,m)}},dependencies:[D.lW,w.Hw,b.a8,b.hq,b.dn,b.dk,b.n5,A.$,f.Ov,M.z,x.X$]})}return h})();var L=o(8071),E=o(1891),B=o(7648);let Z=(()=>{class h{set featureNameId(p){this.featureNameId$.next(p)}set showIf(p){this.showIf$.next(1==p)}constructor(p,y,v,m){this.dialog=p,this.viewContainerRef=y,this.changeDetectorRef=v,this.featuresService=m,this.featureNameId$=new L.X(null),this.showIf$=new L.X(!1),this.feature$=this.featureNameId$.pipe((0,E.w)(U=>this.featuresService.get$(U))),this.show$=(0,c.a)([this.feature$,this.showIf$]).pipe((0,g.U)(([U,J])=>J==(U?.IsEnabled??!1)))}openDialog(){h.openDialog(this.dialog,this.featureNameId$.value,this.viewContainerRef,this.changeDetectorRef)}static openDialog(p,y,v,m){p.open(K,{autoFocus:!1,data:y,viewContainerRef:v,width:"400px"}),m.markForCheck()}static#t=this.\u0275fac=function(y){return new(y||h)(i.Y36(l.uw),i.Y36(i.s_b),i.Y36(i.sBO),i.Y36(B.k))};static#e=this.\u0275dir=i.lG2({type:h,inputs:{featureNameId:"featureNameId",showIf:"showIf"}})}return h})()},9851:(R,F,o)=>{o.d(F,{Y:()=>A});var l=o(9039),c=o(6575),g=o(1268);function C(f,M){1&f&&l.GkF(0)}function i(f,M){if(1&f&&(l.TgZ(0,"mat-hint"),l.YNc(1,C,1,0,"ng-container",2),l.qZA()),2&f){l.oxw();const x=l.MAs(4);l.xp6(1),l.Q6J("ngTemplateOutlet",x)}}function _(f,M){1&f&&l.GkF(0)}function T(f,M){if(1&f&&(l.TgZ(0,"mat-error"),l.YNc(1,_,1,0,"ng-container",2),l.qZA()),2&f){l.oxw();const x=l.MAs(4);l.xp6(1),l.Q6J("ngTemplateOutlet",x)}}function D(f,M){1&f&&l.Hsn(0)}const w=f=>({"hint-box__short":f}),b=["*"];let A=(()=>{class f{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static#t=this.\u0275fac=function(S){return new(S||f)};static#e=this.\u0275cmp=l.Xpm({type:f,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:b,decls:5,vars:4,consts:[[1,"hint-box",3,"ngClass","click"],["content",""],[4,"ngTemplateOutlet"]],template:function(S,I){if(1&S&&(l.F$t(),l.TgZ(0,"div",0),l.NdJ("click",function(){return I.toggleIsShort()}),l.YNc(1,i,2,1)(2,T,2,1),l.qZA(),l.YNc(3,D,1,0,"ng-template",null,1,l.W1O)),2&S){let $;l.Q6J("ngClass",l.VKq(2,w,I.isShort)),l.xp6(1),l.um2(1,!1===($=I.isError)?1:!0===$?2:-1)}},dependencies:[c.mk,c.tP,g.bx,g.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return f})()},40:(R,F,o)=>{o.d(F,{D:()=>g});var l=o(716),c=o(9039);let g=(()=>{class C{constructor(_){this.globalConfigService=_}onClick(_){(navigator.platform.match("Mac")?_.metaKey:_.ctrlKey)&&_.shiftKey&&_.altKey&&(this.globalConfigService.toggleDebugEnabled(),window.getSelection().removeAllRanges())}static#t=this.\u0275fac=function(T){return new(T||C)(c.Y36(l.bE))};static#e=this.\u0275dir=c.lG2({type:C,selectors:[["","appToggleDebug",""]],hostBindings:function(T,D){1&T&&c.NdJ("click",function(b){return D.onClick(b)})}})}return C})()},4472:(R,F,o)=>{function l(c){const g=document.createElement("textarea");g.value=c,g.setAttribute("readonly",""),g.style.position="absolute",g.style.left="-9999px",document.body.appendChild(g);const C=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);g.select(),document.execCommand("copy"),document.body.removeChild(g),C&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(C))}o.d(F,{v:()=>l})},6537:(R,F,o)=>{o.d(F,{z:()=>g});var l=o(9039),c=o(6480);let g=(()=>{class C{constructor(_){this.sanitizer=_}transform(_){return this.sanitizer.bypassSecurityTrustHtml(_)}static#t=this.\u0275fac=function(T){return new(T||C)(l.Y36(c.H7,16))};static#e=this.\u0275pipe=l.Yjl({name:"safeHtml",type:C,pure:!0})}return C})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.01.05/dist/ng-edit/projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-f4d799.57e1841f5fd5c664.js.map